const report = require('../report');
const config = require('../../../config');

// FIXME: This should come in from a config variable
const url = 'http://localhost:' + config.port; // eslint-disable-line

module.exports = {
  'Begin application': (client) => {
    console.log(url);
    client
      .url(url)
      .waitForElementVisible('body', 1000)
      .assert.title('Apply for Health Care: Vets.gov')
      .waitForElementVisible('.form-panel', 3000)
      .click('.form-panel .usa-button-primary')
      .pause(1000)
      .assert.visible('input[name="fname"]')
      .setValue('input[name="fname"]', 'William')
      .setValue('input[name="lname"]', 'Shakespeare')
      .click('.form-panel .usa-button-primary')
      .pause(1000)
      .assert.visible('select[name="veteranBirthMonth"]')
      .setValue('select[name="veteranBirthMonth"]', 'Apr')
      .setValue('select[name="veteranBirthDay"]', '23')
      .setValue('input[name="veteranBirthYear"]', '1980')
      .setValue('input[name="ssn"]', '111-22-3333')
      .click('.form-panel .usa-button-primary')
      .pause(1000)
      .assert.visible('select[name="gender"]')
      .setValue('select[name="gender"]', 'M')
      .click('.form-panel .usa-button-primary')
      .pause(1000)
      .assert.visible('input[name="address"]')
      .setValue('input[name="address"]', '111 S Michigan Ave')
      .setValue('input[name="city"]', 'Chicago')
      .setValue('select[name="country"]', 'USA')
      .setValue('select[name="state"]', 'IL')
      .setValue('input[name="zip"]', '60603')
      .click('.form-panel .usa-button-primary')
      .pause(1000)
      .assert.visible('input[name="email"]')
      .click('.form-panel .usa-button-primary')
      .pause(1000)
      .assert.visible('select[name="lastServiceBranch"]')
      .setValue('select[name="lastServiceBranch"]', 'army')
      .setValue('select[name="lastEntryMonth"]', 'Oct')
      .setValue('select[name="lastEntryDay"]', '10')
      .setValue('input[name="lastEntryYear"]', '2000')
      .setValue('select[name="lastDischargeMonth"]', 'Nov')
      .setValue('select[name="lastDischargeDay"]', '11')
      .setValue('input[name="lastDischargeYear"]', '2004')
      .setValue('select[name="dischargeType"]', 'honorable')
      .click('.form-panel .usa-button-primary')
      .pause(1000)
      .assert.visible('input[name="purpleHeartRecipient"] + label')
      .click('.form-panel .usa-button-primary')
      .pause(1000)
      .assert.visible('input[name="compensableVaServiceConnected-0"] + label')
      .click('input[name="compensableVaServiceConnected-0"] + label')
      .click('input[name="isVaServiceConnected-0"] + label')
      .click('input[name="receivesVaPension-0"] + label')
      .click('.form-panel .usa-button-primary')
      .pause(1000)
      .assert.visible('input[name="provideFinancialInfo-0"] + label')
      .click('input[name="provideFinancialInfo-0"] + label')
      .click('.form-panel .usa-button-primary')
      .pause(1000)
      .assert.visible('select[name="maritalStatus"]')
      .setValue('select[name="maritalStatus"]', 'Married')
      .click('.form-panel')
      .waitForElementVisible('input[name="fname"]', 1000)
      .assert.visible('input[name="fname"]')
      .setValue('input[name="fname"]', 'Anne')
      .setValue('input[name="lname"]', 'Hathaway')
      .setValue('input[name="ssn"]', '444-55-6666')
      .setValue('select[name="spouseBirthMonth"]', 'Aug')
      .setValue('select[name="spouseBirthDay"]', '6')
      .setValue('input[name="spouseBirthYear"]', '1980')
      .setValue('select[name="marriageMonth"]', 'Jun')
      .setValue('select[name="marriageDay"]', '1')
      .setValue('input[name="marriageYear"]', '2010')
      .click('input[name="sameAddress-1"] + label')
      .waitForElementVisible('input[name="address"]', 1000)
      .assert.visible('input[name="address"]')
      .setValue('input[name="address"]', '115 S Michigan Ave')
      .setValue('input[name="city"]', 'Chicago')
      .setValue('select[name="country"]', 'USA')
      .setValue('select[name="state"]', 'IL')
      .setValue('input[name="zip"]', '60603')
      .click('.form-panel .usa-button-primary')
      .pause(1000)
      .assert.visible('input[name="hasChildrenToReport-0"] + label')
      .click('input[name="hasChildrenToReport-0"] + label')
      .waitForElementVisible('input[name="fname"]', 1000)
      .assert.visible('input[name="fname"]')
      .setValue('input[name="fname"]', 'Hamnet')
      .setValue('input[name="lname"]', 'Shakespeare')
      .setValue('select[name="childRelation"]', 'Son')
      .setValue('input[name="ssn"]', '777-88-9999')
      .setValue('select[name="childBirthMonth"]', 'Feb')
      .setValue('select[name="childBirthDay"]', '2')
      .setValue('input[name="childBirthYear"]', '2012')
      .setValue('select[name="childBecameDependentMonth"]', 'Feb')
      .setValue('select[name="childBecameDependentDay"]', '2')
      .setValue('input[name="childBecameDependentYear"]', '2012')
      .click('.form-panel .usa-button-primary')
      .pause(1000)
      .assert.visible('input[name="veteranGrossIncome"]')
      .click('.form-panel .usa-button-primary')
      .pause(1000)
      .assert.visible('input[name="deductibleMedicalExpenses"]')
      .click('.form-panel .usa-button-primary')
      .pause(1000)
      .assert.visible('input[name="isMedicaidEligible-0"] + label')
      .click('input[name="isMedicaidEligible-1"] + label')
      .click('input[name="isEnrolledMedicarePartA-1"] + label')
      .click('.form-panel .usa-button-primary')
      .pause(1000)
      .assert.visible('input[name="isCoveredByHealthInsurance-0"] + label')
      .click('input[name="isCoveredByHealthInsurance-0"] + label')
      .waitForElementVisible('input[name="insuranceName"]', 1000)
      .assert.visible('input[name="insuranceName"]')
      .setValue('input[name="insuranceName"]', 'BCBS')
      .setValue('input[name="insurancePolicyHolderName"]', 'William Shakespeare')
      .setValue('input[name="insurancePolicyNumber"]', '100')
      .click('.form-panel .usa-button-primary')
      .pause(1000)
      .assert.visible('select[name="state"]')
      .setValue('select[name="state"]', 'IL')
      .setValue('select[name="vaMedicalFacility"]', 'EVANSTON CBOC')
      .click('.form-panel .usa-button-primary')
      .pause(1000)
      .assert.visible('button.edit-btn')
      .click('.form-panel .usa-button-primary')
      .pause(1000)
      // TODO: test that submission works and they are redirect to the confirmation page
      .closeWindow();
  },
  tearDown: report
};
